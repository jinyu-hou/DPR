[2024-03-13 00:10:33,711][root][INFO] - CFG's local_rank=-1
[2024-03-13 00:10:33,712][root][INFO] - Env WORLD_SIZE=None
[2024-03-13 00:10:33,712][root][INFO] - Initialized host ip-172-31-67-199.ec2.internal as d.rank -1 on device=cuda, n_gpu=1, world size=1
[2024-03-13 00:10:33,712][root][INFO] - 16-bits training: False 
[2024-03-13 00:10:33,712][root][INFO] - Reading saved model from /home/ec2-user/11711-a2/DPR/dpr/downloads/checkpoint/retriever/multiset/bert-base-encoder.cp
[2024-03-13 00:10:34,002][root][INFO] - model_state_dict keys odict_keys(['model_dict', 'optimizer_dict', 'scheduler_dict', 'offset', 'epoch', 'encoder_params'])
[2024-03-13 00:10:34,002][root][INFO] - CFG:
[2024-03-13 00:10:34,005][root][INFO] - encoder:
  encoder_model_type: hf_bert
  pretrained_model_cfg: bert-base-uncased
  pretrained_file: null
  projection_dim: 0
  sequence_length: 512
  dropout: 0.1
  fix_ctx_encoder: false
  pretrained: true
ctx_sources:
  dpr_wiki:
    _target_: dpr.data.retriever_data.CsvCtxSrc
    file: data.wikipedia_split.psgs_w100
    id_prefix: 'wiki:'
  cmu_lti:
    _target_: dpr.data.retriever_data.CsvCtxSrc
    file: /home/ec2-user/11711-a2/data/chunked_contexts/chunked_doc.tsv
    id_prefix: 'cmu_lti:'
  cmu_lti_papers:
    _target_: dpr.data.retriever_data.CsvCtxSrc
    file: /home/ec2-user/11711-a2/data/chunked_contexts/chunked_doc_papers.tsv
    id_prefix: 'cmu_lti:'
model_file: /home/ec2-user/11711-a2/DPR/dpr/downloads/checkpoint/retriever/multiset/bert-base-encoder.cp
ctx_src: cmu_lti_papers
encoder_type: ctx
out_file: /home/ec2-user/11711-a2/data/context_emb/ctx_emb_papers
do_lower_case: true
shard_id: 0
num_shards: 1
batch_size: 32
tables_as_passages: false
special_tokens: null
tables_chunk_sz: 100
tables_split_type: type1
local_rank: -1
device: cuda
distributed_world_size: 1
distributed_port: null
no_cuda: false
n_gpu: 1
fp16: false
fp16_opt_level: O1

[2024-03-13 00:10:34,904][dpr.models.hf_models][INFO] - Initializing HF BERT Encoder. cfg_name=bert-base-uncased
[2024-03-13 00:10:35,131][dpr.models.hf_models][INFO] - Initializing HF BERT Encoder. cfg_name=bert-base-uncased
[2024-03-13 00:10:35,718][root][INFO] - Loading saved model state ...
[2024-03-13 00:10:35,764][root][INFO] - reading data source: cmu_lti_papers
[2024-03-13 00:10:35,765][dpr.data.retriever_data][INFO] - Reading file /home/ec2-user/11711-a2/data/chunked_contexts/chunked_doc_papers.tsv
[2024-03-13 00:10:35,794][root][INFO] - Producing encodings for passages range: 0 to 9802 (out of total 9802)
[2024-03-13 00:10:37,874][root][INFO] - Encoded passages 160
[2024-03-13 00:10:39,383][root][INFO] - Encoded passages 320
[2024-03-13 00:10:40,905][root][INFO] - Encoded passages 480
[2024-03-13 00:10:42,426][root][INFO] - Encoded passages 640
[2024-03-13 00:10:43,939][root][INFO] - Encoded passages 800
[2024-03-13 00:10:45,451][root][INFO] - Encoded passages 960
[2024-03-13 00:10:46,973][root][INFO] - Encoded passages 1120
[2024-03-13 00:10:48,483][root][INFO] - Encoded passages 1280
[2024-03-13 00:10:50,001][root][INFO] - Encoded passages 1440
[2024-03-13 00:10:51,516][root][INFO] - Encoded passages 1600
[2024-03-13 00:10:53,041][root][INFO] - Encoded passages 1760
[2024-03-13 00:10:54,551][root][INFO] - Encoded passages 1920
[2024-03-13 00:10:56,073][root][INFO] - Encoded passages 2080
[2024-03-13 00:10:57,585][root][INFO] - Encoded passages 2240
[2024-03-13 00:10:59,092][root][INFO] - Encoded passages 2400
[2024-03-13 00:11:00,609][root][INFO] - Encoded passages 2560
[2024-03-13 00:11:02,114][root][INFO] - Encoded passages 2720
[2024-03-13 00:11:03,642][root][INFO] - Encoded passages 2880
[2024-03-13 00:11:05,152][root][INFO] - Encoded passages 3040
[2024-03-13 00:11:06,665][root][INFO] - Encoded passages 3200
[2024-03-13 00:11:08,184][root][INFO] - Encoded passages 3360
[2024-03-13 00:11:09,692][root][INFO] - Encoded passages 3520
[2024-03-13 00:11:11,220][root][INFO] - Encoded passages 3680
[2024-03-13 00:11:12,742][root][INFO] - Encoded passages 3840
[2024-03-13 00:11:14,263][root][INFO] - Encoded passages 4000
[2024-03-13 00:11:15,790][root][INFO] - Encoded passages 4160
[2024-03-13 00:11:17,312][root][INFO] - Encoded passages 4320
[2024-03-13 00:11:18,830][root][INFO] - Encoded passages 4480
[2024-03-13 00:11:20,343][root][INFO] - Encoded passages 4640
[2024-03-13 00:11:21,856][root][INFO] - Encoded passages 4800
[2024-03-13 00:11:23,379][root][INFO] - Encoded passages 4960
[2024-03-13 00:11:24,891][root][INFO] - Encoded passages 5120
[2024-03-13 00:11:26,407][root][INFO] - Encoded passages 5280
[2024-03-13 00:11:27,921][root][INFO] - Encoded passages 5440
[2024-03-13 00:11:29,437][root][INFO] - Encoded passages 5600
[2024-03-13 00:11:30,956][root][INFO] - Encoded passages 5760
[2024-03-13 00:11:32,470][root][INFO] - Encoded passages 5920
[2024-03-13 00:11:33,989][root][INFO] - Encoded passages 6080
[2024-03-13 00:11:35,504][root][INFO] - Encoded passages 6240
[2024-03-13 00:11:37,012][root][INFO] - Encoded passages 6400
[2024-03-13 00:11:38,513][root][INFO] - Encoded passages 6560
[2024-03-13 00:11:40,012][root][INFO] - Encoded passages 6720
[2024-03-13 00:11:41,512][root][INFO] - Encoded passages 6880
[2024-03-13 00:11:43,019][root][INFO] - Encoded passages 7040
[2024-03-13 00:11:44,545][root][INFO] - Encoded passages 7200
[2024-03-13 00:11:46,081][root][INFO] - Encoded passages 7360
[2024-03-13 00:11:47,593][root][INFO] - Encoded passages 7520
[2024-03-13 00:11:49,115][root][INFO] - Encoded passages 7680
[2024-03-13 00:11:50,636][root][INFO] - Encoded passages 7840
[2024-03-13 00:11:52,159][root][INFO] - Encoded passages 8000
[2024-03-13 00:11:53,678][root][INFO] - Encoded passages 8160
[2024-03-13 00:11:55,202][root][INFO] - Encoded passages 8320
[2024-03-13 00:11:56,725][root][INFO] - Encoded passages 8480
[2024-03-13 00:11:58,250][root][INFO] - Encoded passages 8640
[2024-03-13 00:11:59,772][root][INFO] - Encoded passages 8800
[2024-03-13 00:12:01,289][root][INFO] - Encoded passages 8960
[2024-03-13 00:12:02,808][root][INFO] - Encoded passages 9120
[2024-03-13 00:12:04,340][root][INFO] - Encoded passages 9280
[2024-03-13 00:12:05,860][root][INFO] - Encoded passages 9440
[2024-03-13 00:12:07,389][root][INFO] - Encoded passages 9600
[2024-03-13 00:12:08,905][root][INFO] - Encoded passages 9760
[2024-03-13 00:12:09,305][root][INFO] - Writing results to /home/ec2-user/11711-a2/data/context_emb/ctx_emb_papers_0
[2024-03-13 00:12:09,355][root][INFO] - Total passages processed 9802. Written to /home/ec2-user/11711-a2/data/context_emb/ctx_emb_papers_0
