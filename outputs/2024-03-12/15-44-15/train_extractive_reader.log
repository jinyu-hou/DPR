[2024-03-12 15:44:15,071][root][INFO] - CFG's local_rank=-1
[2024-03-12 15:44:15,071][root][INFO] - Env WORLD_SIZE=None
[2024-03-12 15:44:15,071][root][INFO] - Initialized host ip-172-31-67-199.ec2.internal as d.rank -1 on device=cuda, n_gpu=1, world size=1
[2024-03-12 15:44:15,071][root][INFO] - 16-bits training: False 
[2024-03-12 15:44:15,072][root][INFO] - CFG (after gpu  configuration):
[2024-03-12 15:44:15,075][root][INFO] - encoder:
  encoder_model_type: hf_bert
  pretrained_model_cfg: bert-base-uncased
  pretrained_file: null
  projection_dim: 0
  sequence_length: 4000
  dropout: 0.1
  fix_ctx_encoder: false
  pretrained: true
train:
  eval_step: 2000
  batch_size: 16
  dev_batch_size: 24
  adam_eps: 1.0e-08
  adam_betas: (0.9, 0.999)
  max_grad_norm: 1.0
  log_batch_step: 100
  train_rolling_loss_step: 100
  weight_decay: 0.0
  learning_rate: 1.0e-05
  warmup_steps: 0
  gradient_accumulation_steps: 1
  num_train_epochs: 100000
model_file: dpr/downloads/checkpoint/reader/nq-trivia-hybrid/hf-bert-base.cp
do_lower_case: true
seed: 42
train_files: null
dev_files: /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.json
passages_per_question: 24
passages_per_question_predict: 20
output_dir: null
max_n_answers: 10
max_answer_length: 40
eval_top_docs:
- 20
- 100
checkpoint_file_name: dpr_extractive_reader
prediction_results_file: /home/ec2-user/11711-a2/DPR/dpr/workdir/test_reader_output.json
fully_resumable: false
gold_passages_src: null
gold_passages_src_dev: null
num_workers: 16
local_rank: -1
global_loss_buf_sz: 150000
device: cuda
distributed_world_size: 1
distributed_port: null
no_cuda: false
n_gpu: 1
fp16: false
fp16_opt_level: O1
special_tokens: null

[2024-03-12 15:44:15,075][root][INFO] - ***** Initializing components for training *****
[2024-03-12 15:44:15,075][root][INFO] - Checkpoint files []
[2024-03-12 15:44:15,969][dpr.models.hf_models][INFO] - Initializing HF BERT Encoder. cfg_name=bert-base-uncased
[2024-03-12 15:44:16,367][root][INFO] - No train files are specified. Run validation.
[2024-03-12 15:44:16,367][root][INFO] - Validation ...
[2024-03-12 15:44:16,368][root][INFO] - Data files: ['/home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.json']
[2024-03-12 15:44:16,369][root][INFO] - Data are not preprocessed for reader training. Start pre-processing ...
[2024-03-12 15:44:17,602][root][INFO] - Loaded 4167 questions + retrieval results from /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.json
[2024-03-12 15:44:17,801][root][INFO] - Split data into 16 chunks
[2024-03-12 15:44:17,890][root][INFO] - Start batch 261
[2024-03-12 15:44:17,949][root][INFO] - Start batch 261
[2024-03-12 15:44:17,999][root][INFO] - Start batch 261
[2024-03-12 15:44:18,066][root][INFO] - Start batch 261
[2024-03-12 15:44:18,123][root][INFO] - Start batch 261
[2024-03-12 15:44:18,170][root][INFO] - Start batch 261
[2024-03-12 15:44:18,247][root][INFO] - Start batch 261
[2024-03-12 15:44:18,368][root][INFO] - Start batch 261
[2024-03-12 15:44:18,487][root][INFO] - Start batch 261
[2024-03-12 15:44:18,588][root][INFO] - Start batch 261
[2024-03-12 15:44:18,731][root][INFO] - Start batch 261
[2024-03-12 15:44:18,843][root][INFO] - Start batch 261
[2024-03-12 15:44:18,987][root][INFO] - Start batch 261
[2024-03-12 15:44:19,131][root][INFO] - Start batch 261
[2024-03-12 15:44:19,331][root][INFO] - Start batch 261
[2024-03-12 15:44:19,435][root][INFO] - Start batch 252
[2024-03-12 15:45:40,055][root][INFO] - no positive passages samples: 0
[2024-03-12 15:45:40,056][root][INFO] - positive passages from gold samples: 0
[2024-03-12 15:45:40,061][root][INFO] - Serialize 252 results to /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.15.pkl
[2024-03-12 15:45:40,908][root][INFO] - no positive passages samples: 0
[2024-03-12 15:45:40,908][root][INFO] - positive passages from gold samples: 0
[2024-03-12 15:45:40,913][root][INFO] - Serialize 261 results to /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.2.pkl
[2024-03-12 15:45:41,136][root][INFO] - no positive passages samples: 0
[2024-03-12 15:45:41,153][root][INFO] - positive passages from gold samples: 0
[2024-03-12 15:45:41,153][root][INFO] - Serialize 261 results to /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.8.pkl
[2024-03-12 15:45:41,229][root][INFO] - no positive passages samples: 0
[2024-03-12 15:45:41,229][root][INFO] - positive passages from gold samples: 0
[2024-03-12 15:45:41,229][root][INFO] - Serialize 261 results to /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.1.pkl
[2024-03-12 15:45:42,124][root][INFO] - no positive passages samples: 0
[2024-03-12 15:45:42,125][root][INFO] - positive passages from gold samples: 0
[2024-03-12 15:45:42,125][root][INFO] - Serialize 261 results to /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.7.pkl
[2024-03-12 15:45:43,180][root][INFO] - no positive passages samples: 0
[2024-03-12 15:45:43,180][root][INFO] - positive passages from gold samples: 0
[2024-03-12 15:45:43,180][root][INFO] - Serialize 261 results to /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.14.pkl
[2024-03-12 15:45:43,197][root][INFO] - no positive passages samples: 0
[2024-03-12 15:45:43,198][root][INFO] - positive passages from gold samples: 0
[2024-03-12 15:45:43,198][root][INFO] - Serialize 261 results to /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.9.pkl
[2024-03-12 15:45:44,134][root][INFO] - no positive passages samples: 0
[2024-03-12 15:45:44,134][root][INFO] - positive passages from gold samples: 0
[2024-03-12 15:45:44,135][root][INFO] - Serialize 261 results to /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.4.pkl
[2024-03-12 15:45:44,359][root][INFO] - no positive passages samples: 0
[2024-03-12 15:45:44,360][root][INFO] - positive passages from gold samples: 0
[2024-03-12 15:45:44,360][root][INFO] - Serialize 261 results to /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.0.pkl
[2024-03-12 15:45:44,487][root][INFO] - no positive passages samples: 0
[2024-03-12 15:45:44,487][root][INFO] - positive passages from gold samples: 0
[2024-03-12 15:45:44,487][root][INFO] - Serialize 261 results to /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.3.pkl
[2024-03-12 15:45:44,873][root][INFO] - no positive passages samples: 0
[2024-03-12 15:45:44,873][root][INFO] - positive passages from gold samples: 0
[2024-03-12 15:45:44,873][root][INFO] - Serialize 261 results to /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.11.pkl
[2024-03-12 15:45:44,891][root][INFO] - no positive passages samples: 0
[2024-03-12 15:45:44,891][root][INFO] - positive passages from gold samples: 0
[2024-03-12 15:45:44,891][root][INFO] - Serialize 261 results to /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.6.pkl
[2024-03-12 15:45:44,932][root][INFO] - no positive passages samples: 0
[2024-03-12 15:45:44,932][root][INFO] - positive passages from gold samples: 0
[2024-03-12 15:45:44,932][root][INFO] - Serialize 261 results to /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.12.pkl
[2024-03-12 15:45:45,245][root][INFO] - no positive passages samples: 0
[2024-03-12 15:45:45,245][root][INFO] - positive passages from gold samples: 0
[2024-03-12 15:45:45,246][root][INFO] - Serialize 261 results to /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.5.pkl
[2024-03-12 15:45:45,249][root][INFO] - no positive passages samples: 0
[2024-03-12 15:45:45,249][root][INFO] - positive passages from gold samples: 0
[2024-03-12 15:45:45,249][root][INFO] - Serialize 261 results to /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.13.pkl
[2024-03-12 15:45:45,803][root][INFO] - no positive passages samples: 0
[2024-03-12 15:45:45,803][root][INFO] - positive passages from gold samples: 0
[2024-03-12 15:45:45,804][root][INFO] - Serialize 261 results to /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.10.pkl
[2024-03-12 15:45:45,971][root][INFO] - Chunks processed 1
[2024-03-12 15:45:45,972][root][INFO] - Data saved to /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.0.pkl
[2024-03-12 15:45:45,972][root][INFO] - Chunks processed 2
[2024-03-12 15:45:45,972][root][INFO] - Data saved to /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.1.pkl
[2024-03-12 15:45:45,972][root][INFO] - Chunks processed 3
[2024-03-12 15:45:45,972][root][INFO] - Data saved to /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.2.pkl
[2024-03-12 15:45:45,972][root][INFO] - Chunks processed 4
[2024-03-12 15:45:45,972][root][INFO] - Data saved to /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.3.pkl
[2024-03-12 15:45:45,972][root][INFO] - Chunks processed 5
[2024-03-12 15:45:45,972][root][INFO] - Data saved to /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.4.pkl
[2024-03-12 15:45:45,972][root][INFO] - Chunks processed 6
[2024-03-12 15:45:45,972][root][INFO] - Data saved to /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.5.pkl
[2024-03-12 15:45:45,972][root][INFO] - Chunks processed 7
[2024-03-12 15:45:45,972][root][INFO] - Data saved to /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.6.pkl
[2024-03-12 15:45:45,972][root][INFO] - Chunks processed 8
[2024-03-12 15:45:45,973][root][INFO] - Data saved to /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.7.pkl
[2024-03-12 15:45:45,973][root][INFO] - Chunks processed 9
[2024-03-12 15:45:45,973][root][INFO] - Data saved to /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.8.pkl
[2024-03-12 15:45:45,973][root][INFO] - Chunks processed 10
[2024-03-12 15:45:45,973][root][INFO] - Data saved to /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.9.pkl
[2024-03-12 15:45:45,973][root][INFO] - Chunks processed 11
[2024-03-12 15:45:45,973][root][INFO] - Data saved to /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.10.pkl
[2024-03-12 15:45:45,973][root][INFO] - Chunks processed 12
[2024-03-12 15:45:45,973][root][INFO] - Data saved to /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.11.pkl
[2024-03-12 15:45:45,973][root][INFO] - Chunks processed 13
[2024-03-12 15:45:45,973][root][INFO] - Data saved to /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.12.pkl
[2024-03-12 15:45:45,973][root][INFO] - Chunks processed 14
[2024-03-12 15:45:45,973][root][INFO] - Data saved to /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.13.pkl
[2024-03-12 15:45:45,973][root][INFO] - Chunks processed 15
[2024-03-12 15:45:45,973][root][INFO] - Data saved to /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.14.pkl
[2024-03-12 15:45:45,973][root][INFO] - Chunks processed 16
[2024-03-12 15:45:45,973][root][INFO] - Data saved to /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.15.pkl
[2024-03-12 15:45:45,973][root][INFO] - Preprocessed data stored in ['/home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.0.pkl', '/home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.1.pkl', '/home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.2.pkl', '/home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.3.pkl', '/home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.4.pkl', '/home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.5.pkl', '/home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.6.pkl', '/home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.7.pkl', '/home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.8.pkl', '/home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.9.pkl', '/home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.10.pkl', '/home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.11.pkl', '/home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.12.pkl', '/home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.13.pkl', '/home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.14.pkl', '/home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.15.pkl']
[2024-03-12 15:45:46,160][root][INFO] - Reading file /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.0.pkl
[2024-03-12 15:45:46,249][root][INFO] - Aggregated data size: 261
[2024-03-12 15:45:46,250][root][INFO] - Reading file /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.1.pkl
[2024-03-12 15:45:46,340][root][INFO] - Aggregated data size: 522
[2024-03-12 15:45:46,341][root][INFO] - Reading file /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.2.pkl
[2024-03-12 15:45:46,543][root][INFO] - Aggregated data size: 783
[2024-03-12 15:45:46,543][root][INFO] - Reading file /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.3.pkl
[2024-03-12 15:45:46,640][root][INFO] - Aggregated data size: 1044
[2024-03-12 15:45:46,642][root][INFO] - Reading file /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.4.pkl
[2024-03-12 15:45:46,740][root][INFO] - Aggregated data size: 1305
[2024-03-12 15:45:46,741][root][INFO] - Reading file /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.5.pkl
[2024-03-12 15:45:46,961][root][INFO] - Aggregated data size: 1566
[2024-03-12 15:45:46,963][root][INFO] - Reading file /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.6.pkl
[2024-03-12 15:45:47,064][root][INFO] - Aggregated data size: 1827
[2024-03-12 15:45:47,065][root][INFO] - Reading file /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.7.pkl
[2024-03-12 15:45:47,165][root][INFO] - Aggregated data size: 2088
[2024-03-12 15:45:47,166][root][INFO] - Reading file /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.8.pkl
[2024-03-12 15:45:47,261][root][INFO] - Aggregated data size: 2349
[2024-03-12 15:45:47,262][root][INFO] - Reading file /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.9.pkl
[2024-03-12 15:45:47,359][root][INFO] - Aggregated data size: 2610
[2024-03-12 15:45:47,360][root][INFO] - Reading file /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.10.pkl
[2024-03-12 15:45:47,602][root][INFO] - Aggregated data size: 2871
[2024-03-12 15:45:47,605][root][INFO] - Reading file /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.11.pkl
[2024-03-12 15:45:47,704][root][INFO] - Aggregated data size: 3132
[2024-03-12 15:45:47,705][root][INFO] - Reading file /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.12.pkl
[2024-03-12 15:45:47,802][root][INFO] - Aggregated data size: 3393
[2024-03-12 15:45:47,805][root][INFO] - Reading file /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.13.pkl
[2024-03-12 15:45:47,903][root][INFO] - Aggregated data size: 3654
[2024-03-12 15:45:47,904][root][INFO] - Reading file /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.14.pkl
[2024-03-12 15:45:48,001][root][INFO] - Aggregated data size: 3915
[2024-03-12 15:45:48,002][root][INFO] - Reading file /home/ec2-user/11711-a2/DPR/dpr/workdir/test_retriever_output.15.pkl
[2024-03-12 15:45:48,273][root][INFO] - Aggregated data size: 4167
[2024-03-12 15:45:48,273][root][INFO] - Total data size: 4167
[2024-03-12 15:45:48,273][root][INFO] - Calculating shard positions
[2024-03-12 15:45:48,273][root][INFO] - samples_per_shard=4167, shard_start_idx=0, shard_end_idx=4167, max_iterations=173
